<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>nn.Linearå’Œå®é™…åˆå§‹åŒ–çš„Weightå°ºå¯¸æ˜¯ç›¸åçš„ | å¾®å…‰é›†</title>
  
  <meta name="description" content="ä¸€ä¸ªæ–‡é’é£æ ¼çš„ä¸ªäººåšå®¢">
  <meta name="keywords" content="ç”Ÿæ´»,æ€è€ƒ,éšç¬”">
  <meta name="author" content="Kunlin">

  <!-- å­—ä½“ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&family=Noto+Sans+SC:wght@300;400;500&display=swap" rel="stylesheet">

  
<link rel="stylesheet" href="/css/style.css">


  
<meta name="generator" content="Hexo 7.3.0"></head>
<body>

  <header id="header">
  <div class="header-inner">
    <div class="logo-wrap">
      <a href="/" class="logo">
        <svg class="logo-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        å¾®å…‰é›†
      </a>
      <span class="subtitle">åœ¨é»‘å¤œçš„ç¼éš™é‡Œï¼Œæ•è·ä¸€ç‚¹äº®</span>
    </div>
    <nav id="main-nav">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <a class="main-nav-link" href="/">é¦–é¡µ</a>
      
        <a class="main-nav-link" href="/archives">å½’æ¡£</a>
      
        <a class="main-nav-link" href="/categories">åˆ†ç±»</a>
      
        <a class="main-nav-link" href="/tags">æ ‡ç­¾</a>
      
        <a class="main-nav-link" href="/about">å…³äº</a>
      
      <button id="theme-toggle" class="theme-toggle" aria-label="åˆ‡æ¢ä¸»é¢˜">
        <span class="theme-icon">ğŸŒ™</span>
      </button>
    </nav>
  </div>
</header>


  <div id="main">
    <div class="outer">
  <article class="article">
    <div class="article-header">
      <h1 class="article-title">nn.Linearå’Œå®é™…åˆå§‹åŒ–çš„Weightå°ºå¯¸æ˜¯ç›¸åçš„</h1>
      <div class="article-meta">
        
          <span class="article-time">
            <time datetime="2026-01-09">
              2026-01-09
            </time>
          </span>
        
        
          <span class="article-categories">
            åˆ†ç±»ï¼š
            
              
              <a href="/categories/%E6%A0%BC%E7%89%A9/">æ ¼ç‰©</a>
            
          </span>
        
        
          <span class="article-tags">
            æ ‡ç­¾ï¼š
            
              
              <a href="/tags/PyTorch/">#PyTorch</a>
            
          </span>
        
      </div>
    </div>

    <div class="article-content">
      <p>æœ€è¿‘åœ¨æ‰‹æ’•Loraçš„ä»£ç çš„æ—¶å€™ï¼Œå‘ç°ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡ã€‚æ‰‹æ’•ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LoRAModule</span>(nn.Moudle):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, original_layer, lora_rank=<span class="number">4</span></span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        <span class="variable language_">self</span>.original_layer = original_layer</span><br><span class="line">        <span class="variable language_">self</span>.lora_down = nn.Linear(original_layer.in_features, lora_rank, bias=<span class="literal">False</span>)</span><br><span class="line">        <span class="variable language_">self</span>.lora_up = nn.Linear(lora_rank, original_layer.out_features, bias=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Initialize weights</span></span><br><span class="line">        nn.init.normal_(<span class="variable language_">self</span>.lora_down.weight, std=<span class="number">0.02</span>)</span><br><span class="line">        nn.init.zeros_(<span class="variable language_">self</span>.lora_up.weight)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.original_layer + <span class="variable language_">self</span>.lora_up(<span class="variable language_">self</span>.lora_down(x))</span><br><span class="line">   </span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­<code>lora_down</code>çš„åˆå§‹åŒ–æ˜¯<code>nn.Linear(original_layer.in_features, lora_rank)</code>ï¼Œå…¶ä¸­<code>original_layer.in_features</code>å³æˆ‘ä»¬æ·»åŠ loraçš„å±‚çš„è¾“å…¥çš„dimã€‚è€Œlora_upçš„åˆå§‹åŒ–æ˜¯<code>nn.Linear(lora_rank, original_layer.out_features, bias=False)</code>ï¼Œè¿™æ ·çœ‹å¥½åƒæ˜¯æ²¡æœ‰é—®é¢˜çš„, å› ä¸ºloraè®¡ç®—çš„å…¬å¼å¦‚ä¸‹ï¼š</p>
<script type="math/tex; mode=display">
out = \text{Orignal\_layer}(X) + BA(X)</script><p>ä½†æ˜¯å®é™…ä¸Šæˆ‘å¾ˆå¿«å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå…¶ä¸­$B$æ˜¯<code>lora_up</code>ï¼Œ $A$æ˜¯<code>lora_down</code>ï¼Œé‚£ä¹ˆ$BA$çš„å®é™…shapeä¸æ˜¯æ˜¯$[\text{rank}, \text{out}]@[\text{input}, \text{rank}]$ï¼Œæ ¹æœ¬ä¹˜ä¸äº†å‘€ï¼ï¼ä½†æ˜¯ä»£ç å®é™…ä¸Šæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼ŒåŸå› å¦‚æ ‡é¢˜æ‰€ç¤ºï¼š<code>nn.Linear(in_features, out_features)</code> çš„å‚æ•°æ˜¯<code>weight.shape == (out_features, in_features)</code>ï¼Œ è¿™ä¹ˆä¸€æ¥å°±è¯´çš„é€šäº†ï¼ŒBAå®é™…ä¸Šæ˜¯$[\text{out}, \text{rank}]@[\text{rank}, \text{input}]$ã€‚ä»”ç»†ä¸€æŸ¥ï¼Œæ ¹æœ¬åŸå› æ˜¯PyTorchä¸­çº¿æ€§å±‚<code>forward</code> è®¡ç®—æœ¬è´¨æ˜¯ï¼š  </p>
<script type="math/tex; mode=display">
y = x W^\top + b</script><p>æ‰€ä»¥$BAï¼ˆXï¼‰$å®é™…ä¸Šæ˜¯$ X@ï¼ˆBAï¼‰^\top $å³ $XA^\top B^\top$ã€‚</p>

    </div>

    
      <footer class="article-footer">
        <div class="article-tags">
          
            <a class="tag" href="/tags/PyTorch/">#PyTorch</a>
          
        </div>
      </footer>
    
  </article>

  
    

  
</div>

  </div>

  <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2026 Kunlin. ä¿ç•™æ‰€æœ‰æƒåˆ©
        <br>
        <span id="busuanzi_container_site_pv" style="font-family: 'Georgia', serif; font-size: 0.9em; color: #666;">
          &nbsp;Readers: <span id="busuanzi_value_site_uv" style="color: #b73229;"></span>
          &nbsp;|&nbsp;
          Views: <span id="busuanzi_value_site_pv" style="color: #b73229;"></span>
        </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      </div>
      <div class="footer-right">
        <a href="https://yangkunlin.cn">ä¸»é¡µ</a> |
        <a href="https://yangkunlin.cn/archives">æ–‡ç« </a>
      </div>
    </div>
  </div>
</footer>


  <script>
    // ç§»åŠ¨ç«¯å¯¼èˆªåˆ‡æ¢
    const navToggle = document.getElementById('main-nav-toggle');
    const mainNav = document.getElementById('main-nav');

    if (navToggle) {
      navToggle.addEventListener('click', () => {
        mainNav.classList.toggle('show');
      });
    }

    // å¹³æ»‘æ»šåŠ¨
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        const href = this.getAttribute('href');
        if (href !== '#') {
          e.preventDefault();
          const target = document.querySelector(href);
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth'
            });
          }
        }
      });
    });
  </script>

  
<script src="/js/theme-toggle.js"></script>



  

</body>
</html>
